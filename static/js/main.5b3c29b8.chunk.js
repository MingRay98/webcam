(this.webpackJsonpwebcam=this.webpackJsonpwebcam||[]).push([[0],{11:function(e,t,n){e.exports=n(17)},17:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(10),r=n.n(i),s=n(1),c=n(2),d=n(4),l=n(3),u=n(5),v=(n(8),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).init=function(){return window.isMobile?o.a.createElement("div",{className:"header"},o.a.createElement("button",{className:"headerBtn"},"++"),"Webcam",o.a.createElement("button",{className:"headerBtn",onClick:n.props.handleCameraChange}," turn")):o.a.createElement("div",{className:"header",style:{justifyContent:"center"}},"Webcam")},n.state={},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,this.init())}}]),t}(a.Component)),m=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).state={},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("canvas",{id:"photoCanvas"}))}}]),t}(a.Component),h=n(6),f=n.n(h),p=n(7),g=null,b=null,C=0,w=0,E=0,y=0,S=1;var k=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).startSlide=function(e){n.slider.addEventListener("mousemove",n.moveSlide,!1),n.slider.addEventListener("touchmove",n.moveSlide,!1)},n.moveSlide=function(e){S=parseFloat(e.target.value),C=g*S,w=b*S,E=n.videoCanvas.width/2-C/2,y=n.videoCanvas.height/2-w/2},n.stopSlide=function(e){n.slider.removeEventListener("mousemove",n.moveSlide,!1),n.slider.removeEventListener("touchmove",n.moveSlide,!1)},n.drawVideoToCanvas=function(){var e=n.videoCanvas.getContext("2d");e.clearRect(0,0,g,b),e.drawImage(n.video,E,y,C,w),requestAnimationFrame(n.drawVideoToCanvas)},n.handleTurnStream=function(e){console.log(e.target.innerHTML),"turn Off"===e.target.innerHTML?(n.stopStream(),e.target.innerHTML="turn On"):(n.getVideoStream(),n.drawVideoToCanvas(),e.target.innerHTML="turn Off")},n.stopStream=function(){n.video.srcObject.getTracks().forEach((function(e){e.stop()})),n.video.srcObject=null},n.takePhoto=function(){n.photoCanvas.width=g,n.photoCanvas.height=b,n.setState({imgSrc:n.videoCanvas.toDataURL()},(function(){n.drawPhoto()})),document.getElementById("savePhoto").style={display:""}},n.drawPhoto=function(){var e=n.photoCanvas.getContext("2d"),t=new Image;t.onload=function(){S>=1?e.drawImage(t,0,0):(n.photoCanvas.width=g*S,n.photoCanvas.height=b*S,e.drawImage(t,-E,-y))},t.src=n.state.imgSrc},n.downloadCanvasIamge=function(e){var t=document.getElementById("downloadImg");t.href=n.photoCanvas.toDataURL(),t.download="photo.png",t.click()},n.state={imgSrc:""},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){window.isMobile?(g=window.innerWidth,b=4*g/3,alert("\u624b\u6a5f\u6a21\u5f0f")):(g=.49*window.innerWidth,b=.5625*g),C=g,w=b,this.videoCanvas=document.getElementById("videoCanvas"),this.video=document.getElementById("video"),this.videoCanvas.width=g,this.videoCanvas.height=b,this.getVideoStream(),this.drawVideoToCanvas(),this.photoCanvas=document.getElementById("photoCanvas"),this.slider=document.getElementById("slider"),this.slider.addEventListener("mousedown",this.startSlide,!1),this.slider.addEventListener("mouseup",this.stopSlide,!1),this.slider.addEventListener("touchstart",this.startSlide,!1),this.slider.addEventListener("touchend",this.stopSlide,!1)}},{key:"getVideoStream",value:function(){var e=Object(p.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia(this.props.constraints);case 3:t=e.sent,console.log(this.props.constraints),this.video.srcObject=t,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return o.a.createElement("div",{align:"center"},o.a.createElement("video",{autoPlay:!0,id:"video",style:{display:"none"}}),o.a.createElement("canvas",{id:"videoCanvas",style:this.props.videoCanvasStyle,className:"Stream"}),o.a.createElement("br",null),o.a.createElement("input",{type:"range",min:"0.5",max:"1.5",step:"0.1",defaultValue:"1",id:"slider",className:"slider",style:{width:g-10,height:"1rem"}}),o.a.createElement("br",null),o.a.createElement("button",{id:"turn",onClick:this.handleTurnStream},"turn Off"),o.a.createElement("button",{onClick:this.takePhoto},"take photo"),o.a.createElement("button",{id:"savePhoto",style:{display:"none"},onClick:this.downloadCanvasIamge},"save photo"),o.a.createElement("a",{id:"downloadImg"}),o.a.createElement(m,null))}}]),t}(a.Component),O="user",j=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);window.isMobile=j;var I=0,L=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).handleCameraChange=function(){navigator.mediaDevices.enumerateDevices().then((function(e){(e=e.filter((function(e){return"videoinput"===e.kind}))).forEach((function(e){e.label.toLowerCase().search("back")>-1&&e.deviceId}))})),j?"user"===O?(O="environment",n.setState({constraints:{audio:!1,video:{facingMode:"environment"}}})):(O="user",n.setState({constraints:{audio:!1,video:{facingMode:"user"}}})):console.log("Isn't molibe "),n.buttonTurn.click(),n.buttonTurn.click()},n.addBlur=function(){console.log(I+=1),n.setState({videoCanvasStyle:{filter:"blur("+I+"px)"}})},n.minusBlur=function(){console.log(I-=1),n.setState({videoCanvasStyle:{filter:"blur("+I+"px)"}})},n.desktopList=function(){return j?o.a.createElement(k,{facing:O,constraints:n.state.constraints}):o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{style:{width:"50vw"}},o.a.createElement(k,{facing:O,constraints:n.state.constraints,videoCanvasStyle:n.state.videoCanvasStyle})),o.a.createElement("div",{className:"desktopList",style:{width:"50vw"}},o.a.createElement("button",{onClick:n.addBlur},"++"),"blur:",n.state.videoCanvasStyle.filter,o.a.createElement("button",{onClick:n.minusBlur},"--")))},n.state={videoCanvasStyle:{filter:"blur(0px)"},constraints:{video:{facingMode:"user"},audio:!1}},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.buttonTurn=document.getElementById("turn")}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(v,{handleCameraChange:this.handleCameraChange}),this.desktopList())}}]),t}(a.Component),B="1080",M="720",T="",x="",P="1";a.Component,Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,t,n){}},[[11,1,2]]]);
//# sourceMappingURL=main.5b3c29b8.chunk.js.map